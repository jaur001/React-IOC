{"ast":null,"code":"var _jsxFileName = \"C:\\\\Development\\\\Personal\\\\React-IOC\\\\react-ioc\\\\src\\\\components\\\\ReactIOC\\\\ComponentLoader\\\\ComponentLoader.js\",\n    _s = $RefreshSig$();\n\nimport JsonPopulator from \"../../../utils/JsonPopulator\";\nimport { useDispatch } from \"react-redux\";\nimport { reactIocActionNames } from \"../../../redux/confiReducer/reactIocActions\";\nimport { useEffect, useMemo, useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction prepareComponents(components) {\n  const populatedComponents = { ...components\n  };\n\n  for (const compName in populatedComponents) {\n    const Component = populatedComponents[compName];\n\n    populatedComponents[compName] = (comp, parentId, suffixId) => {\n      parentId = parentId ? parentId + \"/\" : \"\";\n      suffixId = suffixId ? suffixId : \"\";\n      const key = parentId + comp.id + suffixId;\n      return /*#__PURE__*/_jsxDEV(Component, {\n        id: key,\n        ...comp.props\n      }, key, false, {\n        fileName: _jsxFileName,\n        lineNumber: 16,\n        columnNumber: 14\n      }, this);\n    };\n  }\n\n  return populatedComponents;\n}\n\nfunction populatePageStructure(pageStructure, components, functions, resources) {\n  const populatedPageStructure = { ...pageStructure\n  };\n  const data = { ...components,\n    ...functions,\n    ...resources\n  };\n  const newState = new JsonPopulator(data).populatePageStructure(populatedPageStructure);\n  return [newState, populatedPageStructure];\n}\n\nfunction ComponentLoader(props) {\n  _s();\n\n  const [loaded, setLoaded] = useState(false);\n  const dispatch = useDispatch();\n  const components = useMemo(() => prepareComponents(props.components), [props.components]);\n  const [newState, pageStructure] = useMemo(() => populatePageStructure(props.pageStructure, components, props.functions, props.resources), [props.pageStructure, components, props.functions, props.resources]);\n  useEffect(() => {\n    dispatch({\n      type: reactIocActionNames.populateState,\n      newState: newState\n    });\n    setLoaded(true);\n  }, [dispatch, newState]);\n  if (!loaded) return /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false);\n  return pageStructure.render(pageStructure);\n}\n\n_s(ComponentLoader, \"pZCM7GKKV3kmiPZaLH1Yu8ViJE4=\", false, function () {\n  return [useDispatch];\n});\n\n_c = ComponentLoader;\nexport default ComponentLoader;\n\nvar _c;\n\n$RefreshReg$(_c, \"ComponentLoader\");","map":{"version":3,"names":["JsonPopulator","useDispatch","reactIocActionNames","useEffect","useMemo","useState","prepareComponents","components","populatedComponents","compName","Component","comp","parentId","suffixId","key","id","props","populatePageStructure","pageStructure","functions","resources","populatedPageStructure","data","newState","ComponentLoader","loaded","setLoaded","dispatch","type","populateState","render"],"sources":["C:/Development/Personal/React-IOC/react-ioc/src/components/ReactIOC/ComponentLoader/ComponentLoader.js"],"sourcesContent":["import JsonPopulator from \"../../../utils/JsonPopulator\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { reactIocActionNames } from \"../../../redux/confiReducer/reactIocActions\";\r\nimport { useEffect, useMemo, useState } from \"react\";\r\n\r\nfunction prepareComponents(components) {\r\n  const populatedComponents = {\r\n    ...components,\r\n  };\r\n  for (const compName in populatedComponents) {\r\n    const Component = populatedComponents[compName];\r\n    populatedComponents[compName] = (comp, parentId, suffixId) => {\r\n      parentId = parentId ? parentId + \"/\" : \"\";\r\n      suffixId = suffixId ? suffixId : \"\";\r\n      const key = parentId + comp.id + suffixId;\r\n      return <Component key={key} id={key} {...comp.props} />;\r\n    };\r\n  }\r\n  return populatedComponents;\r\n}\r\n\r\nfunction populatePageStructure(\r\n  pageStructure,\r\n  components,\r\n  functions,\r\n  resources\r\n) {\r\n  const populatedPageStructure = {\r\n    ...pageStructure,\r\n  };\r\n  const data = {\r\n    ...components,\r\n    ...functions,\r\n    ...resources,\r\n  };\r\n  const newState = new JsonPopulator(data).populatePageStructure(\r\n    populatedPageStructure\r\n  );\r\n  return [newState, populatedPageStructure];\r\n}\r\n\r\nfunction ComponentLoader(props) {\r\n  const [loaded, setLoaded] = useState(false);\r\n  const dispatch = useDispatch();\r\n  const components = useMemo(\r\n    () => prepareComponents(props.components),\r\n    [props.components]\r\n  );\r\n  const [newState, pageStructure] = useMemo(\r\n    () =>\r\n      populatePageStructure(\r\n        props.pageStructure,\r\n        components,\r\n        props.functions,\r\n        props.resources\r\n      ),\r\n    [props.pageStructure, components, props.functions, props.resources]\r\n  );\r\n  useEffect(() => {\r\n    dispatch({\r\n      type: reactIocActionNames.populateState,\r\n      newState: newState,\r\n    });\r\n    setLoaded(true);\r\n  }, [dispatch, newState]);\r\n  if (!loaded) return <></>;\r\n  return pageStructure.render(pageStructure);\r\n}\r\n\r\nexport default ComponentLoader;\r\n"],"mappings":";;;AAAA,OAAOA,aAAP,MAA0B,8BAA1B;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SAASC,mBAAT,QAAoC,6CAApC;AACA,SAASC,SAAT,EAAoBC,OAApB,EAA6BC,QAA7B,QAA6C,OAA7C;;;;AAEA,SAASC,iBAAT,CAA2BC,UAA3B,EAAuC;EACrC,MAAMC,mBAAmB,GAAG,EAC1B,GAAGD;EADuB,CAA5B;;EAGA,KAAK,MAAME,QAAX,IAAuBD,mBAAvB,EAA4C;IAC1C,MAAME,SAAS,GAAGF,mBAAmB,CAACC,QAAD,CAArC;;IACAD,mBAAmB,CAACC,QAAD,CAAnB,GAAgC,CAACE,IAAD,EAAOC,QAAP,EAAiBC,QAAjB,KAA8B;MAC5DD,QAAQ,GAAGA,QAAQ,GAAGA,QAAQ,GAAG,GAAd,GAAoB,EAAvC;MACAC,QAAQ,GAAGA,QAAQ,GAAGA,QAAH,GAAc,EAAjC;MACA,MAAMC,GAAG,GAAGF,QAAQ,GAAGD,IAAI,CAACI,EAAhB,GAAqBF,QAAjC;MACA,oBAAO,QAAC,SAAD;QAAqB,EAAE,EAAEC,GAAzB;QAAA,GAAkCH,IAAI,CAACK;MAAvC,GAAgBF,GAAhB;QAAA;QAAA;QAAA;MAAA,QAAP;IACD,CALD;EAMD;;EACD,OAAON,mBAAP;AACD;;AAED,SAASS,qBAAT,CACEC,aADF,EAEEX,UAFF,EAGEY,SAHF,EAIEC,SAJF,EAKE;EACA,MAAMC,sBAAsB,GAAG,EAC7B,GAAGH;EAD0B,CAA/B;EAGA,MAAMI,IAAI,GAAG,EACX,GAAGf,UADQ;IAEX,GAAGY,SAFQ;IAGX,GAAGC;EAHQ,CAAb;EAKA,MAAMG,QAAQ,GAAG,IAAIvB,aAAJ,CAAkBsB,IAAlB,EAAwBL,qBAAxB,CACfI,sBADe,CAAjB;EAGA,OAAO,CAACE,QAAD,EAAWF,sBAAX,CAAP;AACD;;AAED,SAASG,eAAT,CAAyBR,KAAzB,EAAgC;EAAA;;EAC9B,MAAM,CAACS,MAAD,EAASC,SAAT,IAAsBrB,QAAQ,CAAC,KAAD,CAApC;EACA,MAAMsB,QAAQ,GAAG1B,WAAW,EAA5B;EACA,MAAMM,UAAU,GAAGH,OAAO,CACxB,MAAME,iBAAiB,CAACU,KAAK,CAACT,UAAP,CADC,EAExB,CAACS,KAAK,CAACT,UAAP,CAFwB,CAA1B;EAIA,MAAM,CAACgB,QAAD,EAAWL,aAAX,IAA4Bd,OAAO,CACvC,MACEa,qBAAqB,CACnBD,KAAK,CAACE,aADa,EAEnBX,UAFmB,EAGnBS,KAAK,CAACG,SAHa,EAInBH,KAAK,CAACI,SAJa,CAFgB,EAQvC,CAACJ,KAAK,CAACE,aAAP,EAAsBX,UAAtB,EAAkCS,KAAK,CAACG,SAAxC,EAAmDH,KAAK,CAACI,SAAzD,CARuC,CAAzC;EAUAjB,SAAS,CAAC,MAAM;IACdwB,QAAQ,CAAC;MACPC,IAAI,EAAE1B,mBAAmB,CAAC2B,aADnB;MAEPN,QAAQ,EAAEA;IAFH,CAAD,CAAR;IAIAG,SAAS,CAAC,IAAD,CAAT;EACD,CANQ,EAMN,CAACC,QAAD,EAAWJ,QAAX,CANM,CAAT;EAOA,IAAI,CAACE,MAAL,EAAa,oBAAO,qCAAP;EACb,OAAOP,aAAa,CAACY,MAAd,CAAqBZ,aAArB,CAAP;AACD;;GA1BQM,e;UAEUvB,W;;;KAFVuB,e;AA4BT,eAAeA,eAAf"},"metadata":{},"sourceType":"module"}